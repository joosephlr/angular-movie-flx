<div id="created-movie-page">
    <div id="created-movie-page-content">
        <app-header />
        <div id="created-movie-container">
            <div id="sign-up-container" class="d-flex justify-content-center align-items-center" style="width: 100%; max-width: 1000px; margin: 0 auto;">
                <div class="sign-up-card" style="width: 900px; max-width: 1000px;">
                    <h1 class="sign-up-title text-center">Cadastre seu filme aqui</h1>
                    
                    <!-- Mensagem de sucesso -->
                    <div *ngIf="successMessage" class="alert alert-success alert-dismissible fade show" role="alert">
                        {{ successMessage }}
                    </div>

                    <!-- Mensagem de erro -->
                    <div *ngIf="errorMessage" class="alert alert-danger alert-dismissible fade show" role="alert">
                        {{ errorMessage }}
                    </div>
                    
                    <form class="sign-up-form" [formGroup]="movieForm" (ngSubmit)="onSubmit()">
                        <div class="row mb-3">
                            <div class="col-6">
                                <input 
                                    type="text" 
                                    class="form-control sign-up-input"
                                    style="font-size: 20px; height: 60px;"
                                    placeholder="Nome do filme"
                                    formControlName="title"
                                    [class.is-invalid]="title?.invalid && title?.touched"
                                >
                                <small class="text-danger" *ngIf="title?.invalid && title?.touched">
                                    Nome do filme é obrigatório (mínimo 3 caracteres)
                                </small>
                            </div>
                            <div class="col-6">
                                <input 
                                    type="text" 
                                    class="form-control sign-up-input"
                                    style="font-size: 20px; height: 60px;"
                                    placeholder="Descrição do filme"
                                    formControlName="description"
                                    [class.is-invalid]="description?.invalid && description?.touched"
                                >
                                <small class="text-danger" *ngIf="description?.invalid && description?.touched">
                                    Descrição é obrigatória (mínimo 10 caracteres)
                                </small>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-6 position-relative" style="cursor: pointer;">
                                <input 
                                    #dateInput
                                    type="date" 
                                    class="form-control sign-up-input" 
                                    placeholder="Data de lançamento"
                                    formControlName="releaseDate"
                                    [class.is-invalid]="releaseDate?.invalid && releaseDate?.touched"
                                    style="color: #fff; background-color: #232323; font-size: 20px; height: 60px; cursor: pointer;"
                                    
                                >

                                <small class="text-danger" *ngIf="releaseDate?.invalid && releaseDate?.touched">
                                    Data de lançamento é obrigatória
                                </small>
                            </div>
                            <div class="col-6 position-relative">
                                <input 
                                    type="number" 
                                    class="form-control sign-up-input"
                                    placeholder="Avaliação geral (0-100)"
                                    formControlName="approval"
                                    [class.is-invalid]="approval?.invalid && approval?.touched"
                                    min="0" max="100" step="0.1"
                                    style="color: #fff; background-color: #232323; font-size: 20px; height: 60px;"
                                >
                                <span style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: #d33;"><i class="bi bi-star"></i></span>
                                <small class="text-danger" *ngIf="approval?.invalid && approval?.touched">
                                    Avaliação deve estar entre 0 e 100
                                </small>
                            </div>
                        </div>
                        <div class="row mb-4">
                            <div class="col-6 position-relative">
                                <select 
                                    class="form-select sign-up-input" 
                                    formControlName="provider"
                                    [class.is-invalid]="provider?.invalid && provider?.touched"
                                    [disabled]="isLoading"
                                    style="color: #fff; background-color: #232323; font-size: 20px; height: 60px;"
                                >
                                    <option value="" disabled selected>
                                        {{ isLoading ? 'Carregando provedores...' : 'Aonde está disponível?' }}
                                    </option>
                                    <option *ngFor="let prov of providers" [ngValue]="prov.id">
                                        {{ prov.name }}
                                    </option>
                                </select>
                                <span style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: #d33;"><i class="bi bi-chevron-down"></i></span>
                                <small class="text-danger" *ngIf="provider?.invalid && provider?.touched">
                                    Selecione um provedor
                                </small>
                            </div>
                            <div class="col-6 position-relative">
                                <select 
                                    class="form-select sign-up-input" 
                                    formControlName="category"
                                    [class.is-invalid]="category?.invalid && category?.touched"
                                    [disabled]="isLoading"
                                    style="color: #fff; background-color: #232323; font-size: 20px; height: 60px;"
                                >
                                    <option value="" disabled selected>
                                        {{ isLoading ? 'Carregando categorias...' : 'Qual categoria' }}
                                    </option>
                                    <option *ngFor="let cat of categories" [ngValue]="cat.id">
                                        {{ cat.name }}
                                    </option>
                                </select>
                                <span style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: #d33;"><i class="bi bi-chevron-down"></i></span>
                                <small class="text-danger" *ngIf="category?.invalid && category?.touched">
                                    Selecione uma categoria
                                </small>
                            </div>
                        </div>
                        <button 
                            type="submit" 
                            class="btn sign-up-button w-100 mb-3 creat-movie-button"
                            [disabled]="movieForm.invalid || isSubmitting"
                        >
                            {{ isSubmitting ? 'Cadastrando...' : 'Cadastrar filme' }}
                        </button>
                        <div style="display: flex; justify-content: center;">
                            <a routerLink="" routerLinkActive="active" class="btn btn-default back-button">Voltar</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

